<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Patient Portal â€” MediCare Pro</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/dashboard.css">
  <style>
    .portal-header { background:var(--grad-primary); padding:var(--space-6) 0; }
    .portal-nav { max-width:1100px;margin:0 auto;padding:0 var(--space-6);display:flex;align-items:center;justify-content:space-between; }
    .portal-content { max-width:1100px;margin:0 auto;padding:var(--space-8) var(--space-6); }
    .notif-item { display:flex;align-items:flex-start;gap:12px;padding:14px;border-radius:14px;border:1px solid var(--border-light);transition:background 0.2s; }
    .notif-item:hover { background:var(--bg-secondary); }
    .notif-item.unread { background:var(--primary-50);border-color:var(--primary-100); }
    .portal-page { display:none; }
    .portal-page.active { display:block; animation:fadeIn 0.3s ease; }
  </style>
</head>
<body style="background:var(--bg-secondary);">

<div id="toastContainer" class="toast-container"></div>

<!-- PORTAL HEADER -->
<div class="portal-header">
  <div class="portal-nav">
    <div style="display:flex;align-items:center;gap:12px;">
      <div style="width:40px;height:40px;background:rgba(255,255,255,0.2);border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:20px;">ğŸ¥</div>
      <div>
        <div style="font-family:var(--font-display);font-weight:700;color:white;font-size:18px;">MediCare Pro</div>
        <div style="font-size:11px;color:rgba(255,255,255,0.7);text-transform:uppercase;letter-spacing:0.06em;">Patient Portal</div>
      </div>
    </div>
    <div style="display:flex;align-items:center;gap:16px;">
      <div style="display:flex;gap:4px;background:rgba(255,255,255,0.15);border-radius:16px;padding:4px;">
        <button class="tab-btn active" onclick="showPortalPage('overview', this)" style="color:white;background:rgba(255,255,255,0.2);">Overview</button>
        <button class="tab-btn" onclick="showPortalPage('appointments', this)" style="color:rgba(255,255,255,0.8);">Appointments</button>
        <button class="tab-btn" onclick="showPortalPage('records', this)" style="color:rgba(255,255,255,0.8);">My Records</button>
        <button class="tab-btn" onclick="showPortalPage('notifications', this)" style="color:rgba(255,255,255,0.8);">Notifications <span style="background:var(--error);color:white;border-radius:20px;padding:1px 6px;font-size:10px;margin-left:4px;">3</span></button>
      </div>
      <div style="display:flex;align-items:center;gap:8px;cursor:pointer;background:rgba(255,255,255,0.15);border-radius:50px;padding:6px 14px 6px 6px;">
        <div style="width:32px;height:32px;background:rgba(255,255,255,0.3);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;color:white;font-size:13px;">OS</div>
        <span style="font-size:13px;font-weight:600;color:white;">Omar Saidov</span>
      </div>
      <a href="index.html" style="color:rgba(255,255,255,0.8);font-size:13px;">â† Back to Site</a>
    </div>
  </div>
</div>

<div class="portal-content">

  <!-- ===== OVERVIEW ===== -->
  <div class="portal-page active" id="portal-overview">
    <div class="page-header" style="margin-bottom:var(--space-6);">
      <div>
        <div class="page-title">Welcome back, Omar ğŸ‘‹</div>
        <div class="page-subtitle">Here's a summary of your health activity</div>
      </div>
      <button class="btn btn-primary" onclick="openModal('bookVisitModal')">ğŸ“… Book New Appointment</button>
    </div>

    <div class="dashboard-stats">
      <div class="stat-card primary">
        <div class="stat-icon" style="background:var(--primary-50);">ğŸ“…</div>
        <div class="stat-value">2</div>
        <div class="stat-label">Upcoming Visits</div>
        <div class="stat-change up">Next: Mar 5</div>
      </div>
      <div class="stat-card success">
        <div class="stat-icon" style="background:var(--success-bg);">ğŸ“‹</div>
        <div class="stat-value">12</div>
        <div class="stat-label">Total Visits</div>
        <div class="stat-change up">Since 2023</div>
      </div>
      <div class="stat-card warning">
        <div class="stat-icon" style="background:var(--warning-bg);">ğŸ’Š</div>
        <div class="stat-value">3</div>
        <div class="stat-label">Active Medications</div>
        <div class="stat-change">Lisinopril, Atorvastatin...</div>
      </div>
      <div class="stat-card info">
        <div class="stat-icon" style="background:var(--info-bg);">ğŸ””</div>
        <div class="stat-value">3</div>
        <div class="stat-label">Unread Notifications</div>
        <div class="stat-change down">Action required</div>
      </div>
    </div>

    <div style="display:grid;grid-template-columns:2fr 1fr;gap:var(--space-6);margin-top:var(--space-6);">
      <div class="card">
        <div class="card-header">
          <div style="font-weight:700;">Upcoming Appointments</div>
          <button class="btn btn-ghost btn-sm" onclick="showPortalPage('appointments')">View all â†’</button>
        </div>
        <div class="card-body" style="padding-top:0;">
          <div class="appointment-item">
            <div class="appt-time"><div class="appt-hour">10:30</div><div class="appt-period">AM</div></div>
            <div class="appt-line"></div>
            <div class="appt-info">
              <div class="appt-patient">Cardiology Follow-up</div>
              <div class="appt-doctor">Dr. Amir Aliyev Â· Mar 5, 2026</div>
            </div>
            <span class="badge badge-success">Confirmed</span>
            <button class="btn btn-sm btn-ghost" onclick="cancelAppt(this)">Cancel</button>
          </div>
          <div class="appointment-item">
            <div class="appt-time"><div class="appt-hour">9:00</div><div class="appt-period">AM</div></div>
            <div class="appt-line"></div>
            <div class="appt-info">
              <div class="appt-patient">Annual Physical</div>
              <div class="appt-doctor">Dr. Amir Aliyev Â· Mar 20, 2026</div>
            </div>
            <span class="badge badge-warning">Pending</span>
            <button class="btn btn-sm btn-ghost" onclick="cancelAppt(this)">Cancel</button>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header"><div style="font-weight:700;">Recent Notifications</div></div>
        <div class="card-body" style="padding-top:0;display:flex;flex-direction:column;gap:8px;">
          <div class="notif-item unread">
            <span style="font-size:20px;">ğŸ“…</span>
            <div>
              <div style="font-size:13px;font-weight:700;">Appointment Reminder</div>
              <div style="font-size:12px;color:var(--text-muted);">Your visit with Dr. Aliyev is on Mar 5 at 10:30 AM</div>
              <div style="font-size:11px;color:var(--primary);margin-top:4px;">2 hours ago</div>
            </div>
          </div>
          <div class="notif-item unread">
            <span style="font-size:20px;">ğŸ’Š</span>
            <div>
              <div style="font-size:13px;font-weight:700;">Prescription Ready</div>
              <div style="font-size:12px;color:var(--text-muted);">Your Lisinopril refill is ready at the pharmacy</div>
              <div style="font-size:11px;color:var(--primary);margin-top:4px;">Yesterday</div>
            </div>
          </div>
          <div class="notif-item unread">
            <span style="font-size:20px;">ğŸ“‹</span>
            <div>
              <div style="font-size:13px;font-weight:700;">Lab Results Available</div>
              <div style="font-size:12px;color:var(--text-muted);">Your Jan 15 lipid panel results are ready</div>
              <div style="font-size:11px;color:var(--primary);margin-top:4px;">2 days ago</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Health Summary -->
    <div class="card" style="margin-top:var(--space-6);">
      <div class="card-header"><div style="font-weight:700;">Health Profile</div></div>
      <div class="card-body" style="display:grid;grid-template-columns:repeat(4,1fr);gap:var(--space-5);">
        <div style="text-align:center;padding:16px;background:var(--primary-50);border-radius:16px;">
          <div style="font-size:28px;margin-bottom:6px;">ğŸ©¸</div>
          <div style="font-size:20px;font-weight:800;color:var(--primary);">A+</div>
          <div style="font-size:12px;color:var(--text-muted);">Blood Type</div>
        </div>
        <div style="text-align:center;padding:16px;background:var(--success-bg);border-radius:16px;">
          <div style="font-size:28px;margin-bottom:6px;">âš–ï¸</div>
          <div style="font-size:20px;font-weight:800;color:var(--success);">78 kg</div>
          <div style="font-size:12px;color:var(--text-muted);">Weight</div>
        </div>
        <div style="text-align:center;padding:16px;background:var(--warning-bg);border-radius:16px;">
          <div style="font-size:28px;margin-bottom:6px;">â¤ï¸</div>
          <div style="font-size:20px;font-weight:800;color:var(--warning);">128/84</div>
          <div style="font-size:12px;color:var(--text-muted);">Blood Pressure</div>
        </div>
        <div style="text-align:center;padding:16px;background:var(--error-bg);border-radius:16px;">
          <div style="font-size:28px;margin-bottom:6px;">âš ï¸</div>
          <div style="font-size:20px;font-weight:800;color:var(--error);">Penicillin</div>
          <div style="font-size:12px;color:var(--text-muted);">Allergy Alert</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== APPOINTMENTS PAGE ===== -->
  <div class="portal-page" id="portal-appointments">
    <div class="page-header">
      <div><div class="page-title">My Appointments</div><div class="page-subtitle">View, manage, and book your clinic visits</div></div>
      <button class="btn btn-primary" onclick="openModal('bookVisitModal')">ğŸ“… Book New Visit</button>
    </div>

    <div class="tabs mb-6" style="width:fit-content;">
      <div class="tab-btn active" onclick="filterPortalAppts('upcoming',this)">Upcoming</div>
      <div class="tab-btn" onclick="filterPortalAppts('completed',this)">Completed</div>
      <div class="tab-btn" onclick="filterPortalAppts('cancelled',this)">Cancelled</div>
    </div>

    <div style="display:flex;flex-direction:column;gap:var(--space-4);" id="portalApptList">
      <!-- Rendered by JS -->
    </div>
  </div>

  <!-- ===== RECORDS ===== -->
  <div class="portal-page" id="portal-records">
    <div class="page-header">
      <div><div class="page-title">My Health Records</div><div class="page-subtitle">Complete medical history and documents</div></div>
      <button class="btn btn-secondary">ğŸ“¥ Download Records</button>
    </div>
    <div style="display:grid;grid-template-columns:2fr 1fr;gap:var(--space-6);">
      <div class="card">
        <div class="card-header"><div style="font-weight:700;">Visit History</div></div>
        <div class="card-body">
          <div class="visit-record">
            ${[{d:'Feb 26, 2026',diag:'Hypertension Follow-up',dr:'Dr. Aliyev',notes:'BP improved. Continue Lisinopril. Follow-up in 4 weeks.'},
               {d:'Jan 15, 2026',diag:'Annual Physical Exam',dr:'Dr. Aliyev',notes:'Lipid panel ordered. Slightly elevated cholesterol. Diet change recommended.'},
               {d:'Dec 3, 2025',diag:'Chest Pain â€” R/O MI',dr:'Dr. Aliyev',notes:'ECG normal. Anxiety-related palpitations. Prescribed Lorazepam PRN.'},
               {d:'Oct 22, 2025',diag:'Hypertension Diagnosis',dr:'Dr. Aliyev',notes:'Started Lisinopril 5mg. Home BP monitoring recommended.'}].map(v=>`
            <div class="visit-item">
              <div class="visit-date">ğŸ“… ${v.d} Â· <span style="color:var(--primary);">${v.dr}</span></div>
              <div class="visit-diagnosis">ğŸ¥ ${v.diag}</div>
              <div class="visit-notes">${v.notes}</div>
              <button style="margin-top:8px;" class="btn btn-secondary btn-sm" onclick="showToast('info','Download','Downloading visit summary...')">ğŸ“„ Download Summary</button>
            </div>`).join('')}
          </div>
        </div>
      </div>
      <div style="display:flex;flex-direction:column;gap:var(--space-4);">
        <div class="card">
          <div class="card-header"><div style="font-weight:700;">Current Medications</div></div>
          <div class="card-body" style="display:flex;flex-direction:column;gap:10px;">
            ${[{name:'Lisinopril',dose:'10mg',freq:'Once daily'},
               {name:'Atorvastatin',dose:'20mg',freq:'Once at night'},
               {name:'Lorazepam',dose:'0.5mg',freq:'As needed'}].map(m=>`
            <div style="padding:12px;background:var(--bg-secondary);border-radius:12px;border:1px solid var(--border-light);">
              <div style="font-weight:700;font-size:13px;">ğŸ’Š ${m.name}</div>
              <div style="font-size:12px;color:var(--text-muted);margin-top:2px;">${m.dose} Â· ${m.freq}</div>
            </div>`).join('')}
          </div>
        </div>
        <div class="card">
          <div class="card-header"><div style="font-weight:700;">Lab Results</div></div>
          <div class="card-body" style="display:flex;flex-direction:column;gap:8px;">
            <div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--border-light);">
              <span style="font-size:13px;">ğŸ§ª Lipid Panel</span>
              <div style="display:flex;gap:6px;align-items:center;">
                <span class="badge badge-warning">Elevated</span>
                <button class="btn btn-sm btn-ghost" onclick="showToast('info','View','Opening report...')">View</button>
              </div>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--border-light);">
              <span style="font-size:13px;">ğŸ§« CBC</span>
              <div style="display:flex;gap:6px;align-items:center;">
                <span class="badge badge-success">Normal</span>
                <button class="btn btn-sm btn-ghost" onclick="showToast('info','View','Opening report...')">View</button>
              </div>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;">
              <span style="font-size:13px;">ğŸ« Chest X-Ray</span>
              <div style="display:flex;gap:6px;align-items:center;">
                <span class="badge badge-success">Normal</span>
                <button class="btn btn-sm btn-ghost" onclick="showToast('info','View','Opening image...')">View</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== NOTIFICATIONS ===== -->
  <div class="portal-page" id="portal-notifications">
    <div class="page-header">
      <div><div class="page-title">Notifications</div><div class="page-subtitle">Your health alerts and updates</div></div>
      <button class="btn btn-ghost btn-sm" onclick="showToast('success','Done','All marked as read.')">Mark all read</button>
    </div>
    <div class="card">
      <div class="card-body" style="display:flex;flex-direction:column;gap:10px;">
        ${[{icon:'ğŸ“…',title:'Appointment Reminder',msg:'Your visit with Dr. Amir Aliyev is in 7 days â€” March 5, 2026 at 10:30 AM.',time:'2 hours ago',unread:true},
           {icon:'ğŸ’Š',title:'Prescription Ready',msg:'Your Lisinopril 10mg refill is ready for pickup at City Pharmacy on Oak St.',time:'Yesterday',unread:true},
           {icon:'ğŸ“‹',title:'Lab Results Available',msg:'Your Jan 15 lipid panel results are now available. Please review with your doctor.',time:'2 days ago',unread:true},
           {icon:'âœ…',title:'Appointment Confirmed',msg:'Your March 20, 2026 Annual Physical with Dr. Aliyev has been confirmed.',time:'3 days ago',unread:false},
           {icon:'ğŸ”„',title:'Follow-up Reminder',msg:'It\'s been 4 weeks since your last visit. Consider scheduling a follow-up.',time:'1 week ago',unread:false}].map(n=>`
        <div class="notif-item${n.unread?' unread':''}">
          <div style="font-size:24px;">${n.icon}</div>
          <div style="flex:1;">
            <div style="display:flex;justify-content:space-between;align-items:flex-start;">
              <div style="font-weight:700;font-size:14px;">${n.title}${n.unread?'<span style="display:inline-block;width:7px;height:7px;background:var(--primary);border-radius:50%;margin-left:6px;"></span>':''}</div>
              <div style="font-size:11px;color:var(--text-muted);white-space:nowrap;margin-left:12px;">${n.time}</div>
            </div>
            <div style="font-size:13px;color:var(--text-secondary);margin-top:4px;">${n.msg}</div>
          </div>
        </div>`).join('')}
      </div>
    </div>
  </div>
</div>

<!-- BOOK VISIT MODAL -->
<div class="modal-overlay" id="bookVisitModal">
  <div class="modal modal-lg">
    <div class="modal-header">
      <div class="modal-title">ğŸ“… Book a Visit</div>
      <div class="modal-close" onclick="closeModal('bookVisitModal')">âœ•</div>
    </div>
    <div class="modal-body" style="display:flex;flex-direction:column;gap:var(--space-4);">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-4);">
        <div class="form-group"><label class="form-label">Department</label>
          <select class="form-control"><option>Cardiology</option><option>General Practice</option><option>Neurology</option><option>Ophthalmology</option></select></div>
        <div class="form-group"><label class="form-label">Doctor</label>
          <select class="form-control"><option>Dr. Amir Aliyev</option><option>Dr. Lena Karimova</option><option>Any Available</option></select></div>
        <div class="form-group"><label class="form-label">Preferred Date</label><input type="date" class="form-control"></div>
        <div class="form-group"><label class="form-label">Preferred Time</label>
          <select class="form-control"><option>9:00 AM</option><option>10:00 AM</option><option>11:00 AM</option><option>2:00 PM</option><option>3:00 PM</option></select></div>
      </div>
      <div class="form-group"><label class="form-label">Reason for Visit</label>
        <textarea class="form-control" rows="3" placeholder="Describe your symptoms or reason..."></textarea></div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeModal('bookVisitModal')">Cancel</button>
      <button class="btn btn-primary" onclick="bookPortalVisit()">âœ… Confirm Booking</button>
    </div>
  </div>
</div>

<script>
function showToast(type, title, message='', duration=4000) {
  const icons={success:'âœ…',error:'âŒ',warning:'âš ï¸',info:'â„¹ï¸'};
  const c=document.getElementById('toastContainer');
  if(!c) return;
  const t=document.createElement('div');
  t.className=`toast ${type}`;
  t.innerHTML=`<div class="toast-icon">${icons[type]||'â„¹ï¸'}</div><div class="toast-content"><div class="toast-title">${title}</div><div class="toast-message">${message}</div></div><div class="toast-close" onclick="this.parentElement.remove()">âœ•</div>`;
  c.appendChild(t); setTimeout(()=>t?.remove(), duration);
}
function openModal(id){const e=document.getElementById(id);if(e){e.classList.add('active');document.body.style.overflow='hidden';}}
function closeModal(id){const e=document.getElementById(id);if(e){e.classList.remove('active');document.body.style.overflow='';}}
document.querySelectorAll('.modal-overlay').forEach(o=>o.addEventListener('click',e=>{if(e.target===o)closeModal(o.id);}));

const PORTAL_APPTS = [
  {id:'APT-001',service:'Cardiology Follow-up',doctor:'Dr. Amir Aliyev',date:'Mar 5, 2026',time:'10:30 AM',status:'upcoming'},
  {id:'APT-002',service:'Annual Physical Exam',doctor:'Dr. Amir Aliyev',date:'Mar 20, 2026',time:'9:00 AM',status:'upcoming'},
  {id:'APT-003',service:'Cardiology Consultation',doctor:'Dr. Amir Aliyev',date:'Feb 26, 2026',time:'9:00 AM',status:'completed'},
  {id:'APT-004',service:'Annual Physical',doctor:'Dr. Amir Aliyev',date:'Jan 15, 2026',time:'10:00 AM',status:'completed'},
  {id:'APT-005',service:'Emergency Visit',doctor:'Dr. Aliyev',date:'Dec 3, 2025',time:'2:00 PM',status:'completed'},
  {id:'APT-006',service:'Dermatology',doctor:'Dr. Smith',date:'Nov 10, 2025',time:'3:00 PM',status:'cancelled'},
];

function showPortalPage(name, btn) {
  document.querySelectorAll('.portal-page').forEach(p=>p.classList.remove('active'));
  document.getElementById('portal-'+name)?.classList.add('active');
  if (name==='appointments') renderPortalAppts('upcoming');
}

function filterPortalAppts(filter, btn) {
  document.querySelectorAll('.tabs .tab-btn').forEach(b=>b.classList.remove('active'));
  btn?.classList.add('active');
  renderPortalAppts(filter);
}

function renderPortalAppts(filter='upcoming') {
  const list = document.getElementById('portalApptList');
  if (!list) return;
  const data = PORTAL_APPTS.filter(a=>a.status===filter);
  if (!data.length) { list.innerHTML='<div class="empty-state"><div class="empty-icon">ğŸ“…</div><div class="empty-title">No appointments found</div></div>'; return; }
  const badges={upcoming:'<span class="badge badge-success">Upcoming</span>',completed:'<span class="badge badge-info">Completed</span>',cancelled:'<span class="badge badge-error">Cancelled</span>'};
  list.innerHTML = data.map(a=>`
  <div class="card">
    <div class="card-body" style="display:flex;align-items:center;gap:20px;">
      <div style="width:60px;text-align:center;flex-shrink:0;">
        <div style="font-size:22px;font-weight:800;color:var(--primary);">${a.date.split(', ')[0].split(' ')[1]||'5'}</div>
        <div style="font-size:11px;color:var(--text-muted);">${a.date.split(' ')[0]}</div>
      </div>
      <div style="width:1px;height:50px;background:var(--border-default);flex-shrink:0;"></div>
      <div style="flex:1;">
        <div style="font-weight:700;font-size:15px;">${a.service}</div>
        <div style="font-size:13px;color:var(--text-muted);margin-top:2px;">ğŸ‘¨â€âš•ï¸ ${a.doctor} Â· ğŸ• ${a.time}</div>
      </div>
      <div style="display:flex;align-items:center;gap:10px;">
        ${badges[a.status]||''}
        ${a.status==='upcoming'?`<button class="btn btn-secondary btn-sm" onclick="showToast('info','Reschedule','Opening reschedule form...')">Reschedule</button><button class="btn btn-danger btn-sm" onclick="cancelApptById('${a.id}',this)">Cancel</button>`:''}
        ${a.status==='completed'?`<button class="btn btn-primary btn-sm" onclick="openModal('bookVisitModal')">Book Again</button>`:''}
      </div>
    </div>
  </div>`).join('');
}

function cancelApptById(id, btn) {
  if (confirm('Are you sure you want to cancel this appointment?')) {
    const a = PORTAL_APPTS.find(x=>x.id===id);
    if (a) a.status='cancelled';
    renderPortalAppts('upcoming');
    showToast('warning','Appointment Cancelled','Your appointment has been cancelled.');
  }
}
function cancelAppt(btn) { if (confirm('Cancel this appointment?')) { btn.closest('.appointment-item')?.remove(); showToast('warning','Cancelled','Appointment cancelled.'); } }
function bookPortalVisit() { closeModal('bookVisitModal'); showToast('success','Visit Booked!','Your appointment is confirmed. Check your email.'); }

// Init
showPortalPage('overview');
</script>
</body>
</html>
